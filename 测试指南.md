# FlipHTML5 Downloader 测试指南

## 安装扩展

1. 打开 Chrome 浏览器
2. 访问 `chrome://extensions/`
3. 开启右上角的"开发者模式"
4. 点击"加载已解压的扩展程序"
5. 选择项目的 `build/chrome-mv3-prod/` 目录

## 测试清单

### 1. 基础功能测试

#### ✅ Popup 窗口
- [ ] 点击扩展图标，Popup 正常弹出
- [ ] Popup 显示两个 Tab："扫描控制" 和 "账户与付费"
- [ ] 界面使用 Ant Design 样式，美观整洁

#### ✅ Tab 1: 扫描控制
- [ ] 显示扫描速度滑块（500-3000ms）
- [ ] 滑块可正常拖动并显示数值
- [ ] 显示"启动扫描"按钮
- [ ] 速度设置保存到 localStorage（刷新后保持）

#### ✅ Tab 2: 账户与付费
- [ ] 未登录时显示"使用 Google 登录"按钮
- [ ] 点击登录后按钮变为用户名
- [ ] 显示当前状态：免费版 / 付费版
- [ ] 显示两个付费套餐卡片：
  - 月度订阅：$3.99/月
  - 年度订阅：$19.99/年
- [ ] 点击订阅按钮后状态变为"已激活"
- [ ] 显示退出登录按钮

### 2. 扫描功能测试

#### ✅ 访问目标网站
- [ ] 打开 fliphtml5.com 或 online.fliphtml5.com 的电子书页面
- [ ] 点击扩展图标 → Tab 1 → "启动扫描"

#### ✅ 扫描对话框
- [ ] 页面中央弹出扫描对话框
- [ ] 对话框宽度 800px，居中显示
- [ ] 对话框背景半透明遮罩
- [ ] 显示当前付费状态标签（免费版/付费版）

#### ✅ 扫描设置区
- [ ] 显示扫描速度滑块（与 Popup 同步）
- [ ] 显示 PDF 版式选择：竖版 / 横版 / 正方版
- [ ] 三个单选按钮可正常切换

#### ✅ 扫描过程
- [ ] 点击"开始扫描"按钮
- [ ] 页面自动翻页
- [ ] 进度条实时更新
- [ ] 显示当前页码
- [ ] 图片预览区实时显示扫描到的图片
  - [ ] 每行显示 4 张缩略图
  - [ ] 图片排列整齐
  - [ ] 区域可垂直滚动
  - [ ] 显示页码标签
- [ ] "停止扫描"按钮可正常中断扫描

#### ✅ 扫描完成
- [ ] 显示"扫描完成"提示
- [ ] 进度条显示 100%
- [ ] 显示"下载 PDF"按钮

### 3. PDF 下载测试

#### ✅ 免费版下载
- [ ] 未登录或未付费状态
- [ ] 点击"下载 PDF"按钮
- [ ] 显示加载提示："正在生成 PDF，请稍候..."
- [ ] PDF 成功下载到本地
- [ ] 文件名格式：`fliphtml5-YYYY-MM-DDTHH-MM-SS.pdf`
- [ ] 打开 PDF，每页都有 "DEMO" 水印
  - [ ] 水印位于页面中心
  - [ ] 水印旋转 -45 度
  - [ ] 水印颜色黑色，透明度 80%
  - [ ] 水印字号较大（72px）

#### ✅ 付费版下载
- [ ] 在 Tab 2 中点击订阅（模拟付费）
- [ ] 返回电子书页面，重新扫描
- [ ] 下载 PDF
- [ ] 打开 PDF，**没有水印**

#### ✅ PDF 版式
- [ ] 竖版：A4 纵向（210mm × 297mm）
- [ ] 横版：A4 横向（297mm × 210mm）
- [ ] 正方版：正方形（210mm × 210mm）
- [ ] 图片在页面内完整显示，保持比例

### 4. 边界情况测试

#### ✅ 错误处理
- [ ] 在非 fliphtml5 网站点击"启动扫描"
  - [ ] 显示提示："请在 FlipHTML5 网站上使用此扩展"
- [ ] 扫描中关闭对话框
  - [ ] 弹出确认提示
- [ ] 扫描到 500 页自动停止
- [ ] 网络较慢时图片加载完整

#### ✅ 性能测试
- [ ] 扫描 10 页以内：流畅
- [ ] 扫描 50 页以内：正常
- [ ] 扫描 100 页以上：内存占用合理
- [ ] PDF 生成速度：每页 < 1 秒

### 5. 用户体验测试

#### ✅ 界面美观性
- [ ] 使用 Ant Design 统一风格
- [ ] 颜色搭配协调（蓝色主题）
- [ ] 按钮、卡片圆角一致
- [ ] 间距合理，不拥挤

#### ✅ 交互流畅性
- [ ] 按钮点击有加载状态
- [ ] 滑块拖动流畅
- [ ] 扫描进度实时更新
- [ ] 提示消息及时显示

#### ✅ 中文本地化
- [ ] 所有文本均为中文
- [ ] 提示信息清晰易懂
- [ ] 没有英文或乱码

## 已知限制

1. **模拟功能**：
   - Google 登录为模拟实现（点击即登录）
   - 付费功能为模拟实现（点击即购买）
   - 真实功能将在后续版本中集成

2. **扫描限制**：
   - 最多扫描 500 页
   - 依赖页面结构，结构变化可能导致失败

3. **图片加载**：
   - 扫描速度过快可能导致图片加载失败
   - 建议使用默认速度（1000ms）

## 问题反馈

如发现任何问题，请记录：
- 操作步骤
- 预期结果
- 实际结果
- 浏览器版本
- 电子书 URL

## 开发调试

### 查看日志
1. 打开 DevTools（F12）
2. 切换到 Console 面板
3. 查看扫描进度和错误信息

### 查看 Storage
1. DevTools → Application → Storage → Local Storage
2. 查看 `scanSpeed` 和 `userState` 数据

### 重新构建
```bash
pnpm run build
```

### 开发模式
```bash
pnpm run dev
```
然后加载 `build/chrome-mv3-dev/` 目录
